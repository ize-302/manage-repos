import { detectBrowser, focus, isActiveElement, isRefObject } from "@chakra-ui/utils";
import { usePointerEvent } from "./use-pointer-event";

/**
 * Polyfill to get `relatedTarget` working correctly consistently
 * across all browsers.
 *
 * It ensures that elements receives focus on pointer down if
 * it's not the active active element.
 *
 * @internal
 */
export function useFocusOnPointerDown(props) {
  var {
    doc,
    elements
  } = props;
  var isSafari = detectBrowser("Safari");
  usePointerEvent(doc, "pointerdown", event => {
    if (!isSafari) return;
    var target = event.target;
    var isValidTarget = elements.some(element => {
      if (isRefObject(element)) {
        return target === element.current;
      }

      return target === element;
    });

    if (!isActiveElement(target) && isValidTarget) {
      focus(target);
    }
  });
}
//# sourceMappingURL=use-focus-on-pointerdown.js.map